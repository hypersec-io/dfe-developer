---
# DFE Developer Core - Main Tasks
# Maps to: fedora/install-dfe-developer-core.sh

- name: Load macOS variables
  ansible.builtin.include_vars:
    file: macos.yml
  when: ansible_distribution == 'MacOSX'

- name: Install C development tools
  ansible.builtin.include_tasks:
    file: c_tools.yml
  tags: ['c_tools', 'dev']

- name: Install JFrog CLI
  ansible.builtin.include_tasks:
    file: jfrog.yml
  tags: ['jfrog']

- name: Install Azure CLI
  ansible.builtin.include_tasks:
    file: azure.yml
  tags: ['azure']

- name: Install Node.js and semantic-release
  ansible.builtin.include_tasks:
    file: nodejs.yml
  tags: ['nodejs']

- name: Install Linear CLI
  ansible.builtin.include_tasks:
    file: linear.yml
  tags: ['linear']

- name: Install Slack
  ansible.builtin.include_tasks:
    file: slack.yml
  tags: ['slack']
  when: ansible_env.DISPLAY is defined or ansible_env.WAYLAND_DISPLAY is defined

- name: Install Betterbird
  ansible.builtin.include_tasks:
    file: betterbird.yml
  tags: ['betterbird', 'email']
  when: ansible_distribution in ['Fedora', 'Ubuntu']

- name: Install OpenVPN 3
  ansible.builtin.include_tasks:
    file: openvpn.yml
  tags: ['openvpn', 'vpn']

- name: Install Claude Code CLI
  ansible.builtin.include_tasks:
    file: claude.yml
  tags: ['claude', 'ai']

- name: Install Gitleaks (secret detection)
  ansible.builtin.include_tasks:
    file: gitleaks.yml
  tags: ['gitleaks', 'security']

- name: Install act (GitHub Actions runner)
  ansible.builtin.include_tasks:
    file: act.yml
  tags: ['act', 'ci']

- name: Verify core tools installation
  ansible.builtin.include_tasks:
    file: verify.yml
  tags: ['verify']

- name: Set custom wallpaper (if provided)
  ansible.builtin.include_tasks:
    file: wallpaper.yml
  tags: ['wallpaper']

- name: Disable telemetry and advertising
  ansible.builtin.include_tasks:
    file: telemetry.yml
    apply:
      tags: ['telemetry']
  tags: ['telemetry']
